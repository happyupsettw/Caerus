<?php
/**
 * Author: Panigale
 * Date: 2023/8/9
 * Time: 12:18 PM
 */

namespace Panigale\Caerus\Tests\Unit;

use GuzzleHttp\Client;
use GuzzleHttp\Handler\MockHandler;
use GuzzleHttp\HandlerStack;
use GuzzleHttp\Psr7\Response;
use Illuminate\Foundation\Testing\RefreshDatabase;
use Mockery;
use Panigale\Caerus\Askables\Sport;
use Panigale\Caerus\Caerus;
use Panigale\Caerus\CaerusServiceProvider;
use Panigale\Caerus\SendRequest;
use Panigale\Caerus\Tests\TestCase;

class CaerusTest extends TestCase
{
    protected function getPackageProviders($app)
    {
        return [CaerusServiceProvider::class];
    }

    /**
     * @test
     */
    public function testFetchSportList(){
        //arrange
        $mock = Mockery::mock(Sport::class ,[null])
            ->shouldReceive('fetch')
            ->once()
            ->andReturn('fetch')
            ->getMock();
        $this->app->instance(Sport::class, $mock);

        //action
        $sports = Caerus::fetchSport();

        //assert
        $this->assertEquals('fetch', $sports);
    }

    /**
     * @test
     */
    public function testFetchSport(){
        //arrange
        $mock = Mockery::mock(Sport::class)
            ->shouldReceive('fetch')
            ->once()
            ->andReturn('{"slug":"tennis","name":"\u7db2\u7403","hotGame":[],"liveGame":[],"hotLeagues":[{"slug":"atp-cincinnati","name":"\u8f9b\u8f9b\u90a3\u63d0\u5927\u5e2b\u8cfd","games_count":null},{"slug":"wta-cincinnati","name":"WTA\u8f9b\u8f9b\u90a3\u63d0\u516c\u958b\u8cfd","games_count":null}],"singleGame":[{"id":271950,"name":null,"status":"active","startAt":"2023-08-18 23:00:00","officialCode":1901,"officialId":391960,"isLive":false,"isSingleton":true,"type":2,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":0,"sport":{"name":"\u7db2\u7403","slug":"tennis","status":"\u555f\u7528\u4e2d","id":7},"league":{"name":"WTA\u8f9b\u8f9b\u90a3\u63d0\u516c\u958b\u8cfd","slug":"wta-cincinnati","country":{"name":"WTA","slug":"wta"}},"teams":{"away":null,"home":null},"result":null,"rrc":null,"mac":null,"groups":[]},{"id":272445,"name":null,"status":"active","startAt":"2023-08-18 23:00:00","officialCode":2027,"officialId":392485,"isLive":false,"isSingleton":true,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":3,"sport":{"name":"\u7db2\u7403","slug":"tennis","status":"\u555f\u7528\u4e2d","id":7},"league":{"name":"WTA\u8f9b\u8f9b\u90a3\u63d0\u516c\u958b\u8cfd","slug":"wta-cincinnati","country":{"name":"WTA","slug":"wta"}},"teams":{"away":{"name":"\u842c\u5353\u7d22\u5a03","slug":"vondrousova-marketa","id":1378},"home":{"name":"\u65af\u5a01\u96c5\u8482","slug":"swiatek-iga","id":2239}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":1,"status":"active","playId":2,"options":[{"name":"*2*","optionId":253,"odds":"3.50","trend":null,"status":"active","id":14656744,"officialCode":"402"},{"name":"*1*","optionId":254,"odds":"1.15","trend":null,"status":"active","id":14656745,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4415878},"layoutId":1,"playId":2},{"name":"\u8b93\u5206[\u7e3d\u5c40\u6578]","markets":{"handicap":"-4.50","minPasses":1,"status":"active","playId":12,"options":[{"name":"*2*\uff08+4.5\uff09","optionId":103,"odds":"1.85","trend":null,"status":"active","id":14656746,"officialCode":"447"},{"name":"*1*\uff08-4.50\uff09","optionId":102,"odds":"1.65","trend":null,"status":"active","id":14656747,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4415879},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5c40\u6578]","markets":{"handicap":"20.50","minPasses":1,"status":"active","playId":10,"options":[{"name":"\u5927 20.50","optionId":59,"odds":"1.80","trend":null,"status":"active","id":14656748,"officialCode":"472"},{"name":"\u5c0f 20.50","optionId":60,"odds":"1.70","trend":null,"status":"active","id":14656749,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4415880},"layoutId":2,"playId":10}]},{"id":271951,"name":null,"status":"active","startAt":"2023-08-19 01:00:00","officialCode":1900,"officialId":391962,"isLive":false,"isSingleton":true,"type":2,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":0,"sport":{"name":"\u7db2\u7403","slug":"tennis","status":"\u555f\u7528\u4e2d","id":7},"league":{"name":"\u8f9b\u8f9b\u90a3\u63d0\u5927\u5e2b\u8cfd","slug":"atp-cincinnati","country":{"name":"ATP","slug":"atp"}},"teams":{"away":null,"home":null},"result":null,"rrc":null,"mac":null,"groups":[]},{"id":272444,"name":null,"status":"active","startAt":"2023-08-19 01:00:00","officialCode":2026,"officialId":392478,"isLive":false,"isSingleton":true,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":3,"sport":{"name":"\u7db2\u7403","slug":"tennis","status":"\u555f\u7528\u4e2d","id":7},"league":{"name":"\u8f9b\u8f9b\u90a3\u63d0\u5927\u5e2b\u8cfd","slug":"atp-cincinnati","country":{"name":"ATP","slug":"atp"}},"teams":{"away":{"name":"\u5e15\u6bd4\u502b","slug":"popyrin-alexei","id":2035},"home":{"name":"\u80e1\u5361\u5947","slug":"hurkacz-hubert","id":1393}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":1,"status":"active","playId":2,"options":[{"name":"*2*","optionId":253,"odds":"3.30","trend":null,"status":"active","id":14656726,"officialCode":"402"},{"name":"*1*","optionId":254,"odds":"1.18","trend":null,"status":"active","id":14656727,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4415870},"layoutId":1,"playId":2},{"name":"\u8b93\u5206[\u7e3d\u5c40\u6578]","markets":{"handicap":"-3.50","minPasses":1,"status":"active","playId":12,"options":[{"name":"*2*\uff08+3.5\uff09","optionId":103,"odds":"1.55","trend":null,"status":"active","id":14656728,"officialCode":"447"},{"name":"*1*\uff08-3.50\uff09","optionId":102,"odds":"1.95","trend":null,"status":"active","id":14656729,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4415871},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5c40\u6578]","markets":{"handicap":"23.50","minPasses":1,"status":"active","playId":10,"options":[{"name":"\u5927 23.50","optionId":59,"odds":"1.85","trend":null,"status":"active","id":14656730,"officialCode":"472"},{"name":"\u5c0f 23.50","optionId":60,"odds":"1.65","trend":null,"status":"active","id":14656731,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4415872},"layoutId":2,"playId":10}]},{"id":272504,"name":null,"status":"active","startAt":"2023-08-19 01:00:00","officialCode":2035,"officialId":392536,"isLive":false,"isSingleton":true,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":3,"sport":{"name":"\u7db2\u7403","slug":"tennis","status":"\u555f\u7528\u4e2d","id":7},"league":{"name":"WTA\u8f9b\u8f9b\u90a3\u63d0\u516c\u958b\u8cfd","slug":"wta-cincinnati","country":{"name":"WTA","slug":"wta"}},"teams":{"away":{"name":"\u5e03\u8332\u67ef\u5a03","slug":"bouzkova-marie","id":1979},"home":{"name":"\u5361\u863f\u8389\u5a1c.\u7a46\u970d\u5a03","slug":"muchova-karolina","id":1976}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":1,"status":"active","playId":2,"options":[{"name":"*2*","optionId":253,"odds":"2.15","trend":null,"status":"active","id":14658303,"officialCode":"402"},{"name":"*1*","optionId":254,"odds":"1.45","trend":null,"status":"active","id":14658304,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4416334},"layoutId":1,"playId":2},{"name":"\u8b93\u5206[\u7e3d\u5c40\u6578]","markets":{"handicap":"-3.50","minPasses":1,"status":"active","playId":12,"options":[{"name":"*2*\uff08+3.5\uff09","optionId":103,"odds":"1.65","trend":null,"status":"active","id":14658305,"officialCode":"447"},{"name":"*1*\uff08-3.50\uff09","optionId":102,"odds":"1.85","trend":null,"status":"active","id":14658306,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4416335},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5c40\u6578]","markets":{"handicap":"21.50","minPasses":1,"status":"active","playId":10,"options":[{"name":"\u5927 21.50","optionId":59,"odds":"1.80","trend":null,"status":"active","id":14658307,"officialCode":"472"},{"name":"\u5c0f 21.50","optionId":60,"odds":"1.70","trend":null,"status":"active","id":14658308,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4416336},"layoutId":2,"playId":10}]},{"id":272495,"name":null,"status":"active","startAt":"2023-08-19 03:00:00","officialCode":2029,"officialId":392527,"isLive":false,"isSingleton":true,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":2,"sport":{"name":"\u7db2\u7403","slug":"tennis","status":"\u555f\u7528\u4e2d","id":7},"league":{"name":"\u8f9b\u8f9b\u90a3\u63d0\u5927\u5e2b\u8cfd","slug":"atp-cincinnati","country":{"name":"ATP","slug":"atp"}},"teams":{"away":{"name":"\u99ac\u514b\u65af.\u5e15\u585e\u723e","slug":"purcell-max","id":2475},"home":{"name":"\u963f\u5361\u62c9\u8332\u52a0\u83f2\u4e9e","slug":"alcaraz-garfia-carlos","id":3811}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u8b93\u5206[\u7e3d\u5c40\u6578]","markets":{"handicap":"-5.50","minPasses":1,"status":"active","playId":12,"options":[{"name":"*2*\uff08+5.5\uff09","optionId":103,"odds":"1.80","trend":null,"status":"active","id":14658168,"officialCode":"447"},{"name":"*1*\uff08-5.50\uff09","optionId":102,"odds":"1.70","trend":null,"status":"active","id":14658169,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4416278},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5c40\u6578]","markets":{"handicap":"19.50","minPasses":1,"status":"active","playId":10,"options":[{"name":"\u5927 19.50","optionId":59,"odds":"1.80","trend":null,"status":"active","id":14658170,"officialCode":"472"},{"name":"\u5c0f 19.50","optionId":60,"odds":"1.70","trend":null,"status":"active","id":14658171,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4416279},"layoutId":2,"playId":10}]},{"id":272499,"name":null,"status":"active","startAt":"2023-08-19 03:00:00","officialCode":2033,"officialId":392531,"isLive":false,"isSingleton":true,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":3,"sport":{"name":"\u7db2\u7403","slug":"tennis","status":"\u555f\u7528\u4e2d","id":7},"league":{"name":"WTA\u8f9b\u8f9b\u90a3\u63d0\u516c\u958b\u8cfd","slug":"wta-cincinnati","country":{"name":"WTA","slug":"wta"}},"teams":{"away":{"name":"\u9ad8\u8299","slug":"gauff-cori","id":2333},"home":{"name":"J.\u5bf6\u8389\u59ae","slug":"paolini-jasmine","id":2497}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":1,"status":"active","playId":2,"options":[{"name":"*2*","optionId":253,"odds":"1.02","trend":null,"status":"active","id":14658229,"officialCode":"402"},{"name":"*1*","optionId":254,"odds":"5.75","trend":null,"status":"active","id":14658230,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4416305},"layoutId":1,"playId":2},{"name":"\u8b93\u5206[\u7e3d\u5c40\u6578]","markets":{"handicap":"5.50","minPasses":1,"status":"active","playId":12,"options":[{"name":"*2*\uff08-5.5\uff09","optionId":103,"odds":"1.55","trend":null,"status":"active","id":14658231,"officialCode":"447"},{"name":"*1*\uff08+5.5\uff09","optionId":102,"odds":"1.95","trend":null,"status":"active","id":14658232,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4416306},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5c40\u6578]","markets":{"handicap":"18.50","minPasses":1,"status":"active","playId":10,"options":[{"name":"\u5927 18.50","optionId":59,"odds":"1.65","trend":null,"status":"active","id":14658233,"officialCode":"472"},{"name":"\u5c0f 18.50","optionId":60,"odds":"1.85","trend":null,"status":"active","id":14658234,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4416307},"layoutId":2,"playId":10}]},{"id":272496,"name":null,"status":"active","startAt":"2023-08-19 07:00:00","officialCode":2030,"officialId":392528,"isLive":false,"isSingleton":true,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":3,"sport":{"name":"\u7db2\u7403","slug":"tennis","status":"\u555f\u7528\u4e2d","id":7},"league":{"name":"\u8f9b\u8f9b\u90a3\u63d0\u5927\u5e2b\u8cfd","slug":"atp-cincinnati","country":{"name":"ATP","slug":"atp"}},"teams":{"away":{"name":"A.\u8332\u7dad\u5217\u592b","slug":"zverev-alexander","id":1444},"home":{"name":"\u99ac\u7d0d\u91cc\u8afe","slug":"mannarino-adrian","id":1359}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":1,"status":"active","playId":2,"options":[{"name":"*2*","optionId":253,"odds":"1.15","trend":null,"status":"active","id":14658184,"officialCode":"402"},{"name":"*1*","optionId":254,"odds":"3.50","trend":null,"status":"active","id":14658185,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4416285},"layoutId":1,"playId":2},{"name":"\u8b93\u5206[\u7e3d\u5c40\u6578]","markets":{"handicap":"4.50","minPasses":1,"status":"active","playId":12,"options":[{"name":"*2*\uff08-4.5\uff09","optionId":103,"odds":"1.80","trend":null,"status":"active","id":14658186,"officialCode":"447"},{"name":"*1*\uff08+4.5\uff09","optionId":102,"odds":"1.70","trend":null,"status":"active","id":14658187,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4416286},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5c40\u6578]","markets":{"handicap":"21.50","minPasses":1,"status":"active","playId":10,"options":[{"name":"\u5927 21.50","optionId":59,"odds":"1.85","trend":null,"status":"active","id":14658188,"officialCode":"472"},{"name":"\u5c0f 21.50","optionId":60,"odds":"1.65","trend":null,"status":"active","id":14658189,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4416287},"layoutId":2,"playId":10}]},{"id":272505,"name":null,"status":"active","startAt":"2023-08-19 07:00:00","officialCode":2036,"officialId":392537,"isLive":false,"isSingleton":true,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":3,"sport":{"name":"\u7db2\u7403","slug":"tennis","status":"\u555f\u7528\u4e2d","id":7},"league":{"name":"WTA\u8f9b\u8f9b\u90a3\u63d0\u516c\u958b\u8cfd","slug":"wta-cincinnati","country":{"name":"WTA","slug":"wta"}},"teams":{"away":{"name":"\u838e\u82ad\u84ee\u5361","slug":"sabalenka-aryna","id":1381},"home":{"name":"\u52a0\u535a","slug":"jabeur-ons","id":1612}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":1,"status":"active","playId":2,"options":[{"name":"*2*","optionId":253,"odds":"1.45","trend":null,"status":"active","id":14658321,"officialCode":"402"},{"name":"*1*","optionId":254,"odds":"2.15","trend":null,"status":"active","id":14658322,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4416342},"layoutId":1,"playId":2},{"name":"\u8b93\u5206[\u7e3d\u5c40\u6578]","markets":{"handicap":"2.50","minPasses":1,"status":"active","playId":12,"options":[{"name":"*2*\uff08-2.5\uff09","optionId":103,"odds":"1.75","trend":null,"status":"active","id":14658323,"officialCode":"447"},{"name":"*1*\uff08+2.5\uff09","optionId":102,"odds":"1.75","trend":null,"status":"active","id":14658324,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4416343},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5c40\u6578]","markets":{"handicap":"21.50","minPasses":1,"status":"active","playId":10,"options":[{"name":"\u5927 21.50","optionId":59,"odds":"1.70","trend":null,"status":"active","id":14658325,"officialCode":"472"},{"name":"\u5c0f 21.50","optionId":60,"odds":"1.80","trend":null,"status":"active","id":14658326,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4416344},"layoutId":2,"playId":10}]},{"id":272498,"name":null,"status":"active","startAt":"2023-08-19 08:30:00","officialCode":2031,"officialId":392530,"isLive":false,"isSingleton":true,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":3,"sport":{"name":"\u7db2\u7403","slug":"tennis","status":"\u555f\u7528\u4e2d","id":7},"league":{"name":"\u8f9b\u8f9b\u90a3\u63d0\u5927\u5e2b\u8cfd","slug":"atp-cincinnati","country":{"name":"ATP","slug":"atp"}},"teams":{"away":{"name":"N.\u55ac\u79d1\u7dad\u5947","slug":"djokovic-novak","id":1252},"home":{"name":"\u5f17\u91cc\u8328","slug":"fritz-taylor","id":1615}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":1,"status":"active","playId":2,"options":[{"name":"*2*","optionId":253,"odds":"1.10","trend":null,"status":"active","id":14658211,"officialCode":"402"},{"name":"*1*","optionId":254,"odds":"4.00","trend":null,"status":"active","id":14658212,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4416297},"layoutId":1,"playId":2},{"name":"\u8b93\u5206[\u7e3d\u5c40\u6578]","markets":{"handicap":"4.50","minPasses":1,"status":"active","playId":12,"options":[{"name":"*2*\uff08-4.5\uff09","optionId":103,"odds":"1.95","trend":null,"status":"active","id":14658213,"officialCode":"447"},{"name":"*1*\uff08+4.5\uff09","optionId":102,"odds":"1.55","trend":null,"status":"active","id":14658214,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4416298},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5c40\u6578]","markets":{"handicap":"21.50","minPasses":1,"status":"active","playId":10,"options":[{"name":"\u5927 21.50","optionId":59,"odds":"1.65","trend":null,"status":"active","id":14658215,"officialCode":"472"},{"name":"\u5c0f 21.50","optionId":60,"odds":"1.85","trend":null,"status":"active","id":14658216,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4416299},"layoutId":2,"playId":10}]}],"en":"tennis"}')
            ->shouldReceive('setSport');

        $this->app->instance(Sport::class, $mock->getMock());

        //action
        $sport = Caerus::fetchSport('tennis');
        $result = json_decode($sport ,true);

        //assert
        $this->assertArrayHasKey('slug', $result);
        $this->assertArrayHasKey('liveGame' ,$result);
    }

    /**
     * @test
     */
    public function it_should_fetch_data()
    {
        $this->assertTrue(true);
    }

    protected function mockRequest($method ,$response)
    {
        $mocResponse = new Response(200 ,[] ,$response);
        $mockHandler = new MockHandler([$mocResponse]);
        $handlerStack = HandlerStack::create($mockHandler);
        $client = new Client(['handler' => $handlerStack]);
        return Mockery::mock(SendRequest::class)
                    ->shouldReceive('send')
                    ->once()
                    ->andReturn($client->request($method ,''))
                    ->getMock();
    }

    /**
     * @test
     * @throws \Exception
     */
    public function testFetchLeague(){
        //arrange

        //action
        $caerus = new Caerus($this->mockRequest(
            'get' ,
            '{"slug":"segunda-division","name":"\u897f\u73ed\u7259\u4e59\u7d1a\u806f\u8cfd","country":{"slug":"spain","name":"\u897f\u73ed\u7259"},"sport":{"slug":"football","name":"\u8db3\u7403"},"groups":[{"date":"2023-08-26","games":[{"id":273032,"name":null,"status":"active","startAt":"2023-08-26 03:30:00","officialCode":558,"officialId":393104,"isLive":false,"isSingleton":false,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":14,"sport":{"name":"\u8db3\u7403","slug":"football","status":"\u555f\u7528\u4e2d","id":1},"league":{"name":"\u897f\u73ed\u7259\u4e59\u7d1a\u806f\u8cfd","slug":"segunda-division","country":{"name":"\u897f\u73ed\u7259","slug":"spain"}},"teams":{"away":{"name":"\u840a\u842c\u7279","slug":"ud-levante","id":310},"home":{"name":"\u5361\u5854\u8d6b\u7d0d","slug":"fc-cartagena","id":5276}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":3,"status":"active","playId":2,"options":[{"name":"*2*","optionId":83,"odds":"2.30","trend":null,"status":"active","id":14673633,"officialCode":"402"},{"name":"\u548c\u5c40","optionId":84,"odds":"2.80","trend":null,"status":"active","id":14673634,"officialCode":"401"},{"name":"*1*","optionId":82,"odds":"2.40","trend":null,"status":"active","id":14673635,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420786},"layoutId":1,"playId":2},{"name":"\u8b93\u5206","markets":{"handicap":"1.00","minPasses":3,"status":"active","playId":12,"options":[{"name":"*2*\uff08-1\uff09","optionId":342,"odds":"5.50","trend":null,"status":"active","id":14673636,"officialCode":"447"},{"name":"\u548c\u5c40","optionId":343,"odds":"4.00","trend":null,"status":"active","id":14673637,"officialCode":"446"},{"name":"*1*\uff08+1\uff09","optionId":344,"odds":"1.30","trend":null,"status":"active","id":14673638,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420787},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5206]","markets":{"handicap":"2.50","minPasses":3,"status":"active","playId":10,"options":[{"name":"\u5927 2.50","optionId":360,"odds":"2.15","trend":null,"status":"active","id":14673639,"officialCode":"472"},{"name":"\u5c0f 2.50","optionId":359,"odds":"1.45","trend":null,"status":"active","id":14673640,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420788},"layoutId":2,"playId":10}]},{"id":273033,"name":null,"status":"active","startAt":"2023-08-26 23:00:00","officialCode":559,"officialId":393105,"isLive":false,"isSingleton":false,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":12,"sport":{"name":"\u8db3\u7403","slug":"football","status":"\u555f\u7528\u4e2d","id":1},"league":{"name":"\u897f\u73ed\u7259\u4e59\u7d1a\u806f\u8cfd","slug":"segunda-division","country":{"name":"\u897f\u73ed\u7259","slug":"spain"}},"teams":{"away":{"name":"\u7687\u5bb6\u5967\u7dad\u8036\u591a","slug":"real-oviedo","id":480},"home":{"name":"\u5e03\u54e5\u65af","slug":"burgos","id":5862}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":3,"status":"active","playId":2,"options":[{"name":"*2*","optionId":83,"odds":"2.70","trend":null,"status":"active","id":14673708,"officialCode":"402"},{"name":"\u548c\u5c40","optionId":84,"odds":"2.55","trend":null,"status":"active","id":14673709,"officialCode":"401"},{"name":"*1*","optionId":82,"odds":"2.25","trend":null,"status":"active","id":14673710,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420800},"layoutId":1,"playId":2},{"name":"\u8b93\u5206","markets":{"handicap":"-1.00","minPasses":3,"status":"active","playId":12,"options":[{"name":"*2*\uff08+1\uff09","optionId":342,"odds":"1.30","trend":null,"status":"active","id":14673711,"officialCode":"447"},{"name":"\u548c\u5c40","optionId":343,"odds":"3.75","trend":null,"status":"active","id":14673712,"officialCode":"446"},{"name":"*1*\uff08-1.00\uff09","optionId":344,"odds":"5.75","trend":null,"status":"active","id":14673713,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420801},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5206]","markets":{"handicap":"2.50","minPasses":3,"status":"active","playId":10,"options":[{"name":"\u5927 2.50","optionId":360,"odds":"2.85","trend":null,"status":"active","id":14673714,"officialCode":"472"},{"name":"\u5c0f 2.50","optionId":359,"odds":"1.25","trend":null,"status":"active","id":14673715,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420802},"layoutId":2,"playId":10}]}]},{"date":"2023-08-27","games":[{"id":273034,"name":null,"status":"active","startAt":"2023-08-27 01:00:00","officialCode":561,"officialId":393106,"isLive":false,"isSingleton":false,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":14,"sport":{"name":"\u8db3\u7403","slug":"football","status":"\u555f\u7528\u4e2d","id":1},"league":{"name":"\u897f\u73ed\u7259\u4e59\u7d1a\u806f\u8cfd","slug":"segunda-division","country":{"name":"\u897f\u73ed\u7259","slug":"spain"}},"teams":{"away":{"name":"\u85a9\u62c9\u6208\u85a9","slug":"real-zaragoza","id":466},"home":{"name":"\u7279\u5167\u91cc\u8cbb","slug":"cd-tenerife","id":523}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":3,"status":"active","playId":2,"options":[{"name":"*2*","optionId":83,"odds":"3.30","trend":null,"status":"active","id":14673778,"officialCode":"402"},{"name":"\u548c\u5c40","optionId":84,"odds":"2.75","trend":null,"status":"active","id":14673779,"officialCode":"401"},{"name":"*1*","optionId":82,"odds":"1.85","trend":null,"status":"active","id":14673780,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420812},"layoutId":1,"playId":2},{"name":"\u8b93\u5206","markets":{"handicap":"-1.00","minPasses":3,"status":"active","playId":12,"options":[{"name":"*2*\uff08+1\uff09","optionId":342,"odds":"1.50","trend":null,"status":"active","id":14673781,"officialCode":"447"},{"name":"\u548c\u5c40","optionId":343,"odds":"3.40","trend":null,"status":"active","id":14673782,"officialCode":"446"},{"name":"*1*\uff08-1.00\uff09","optionId":344,"odds":"4.25","trend":null,"status":"active","id":14673783,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420813},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5206]","markets":{"handicap":"2.50","minPasses":3,"status":"active","playId":10,"options":[{"name":"\u5927 2.50","optionId":360,"odds":"2.45","trend":null,"status":"active","id":14673784,"officialCode":"472"},{"name":"\u5c0f 2.50","optionId":359,"odds":"1.35","trend":null,"status":"active","id":14673785,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420814},"layoutId":2,"playId":10}]},{"id":273035,"name":null,"status":"active","startAt":"2023-08-27 03:30:00","officialCode":562,"officialId":393107,"isLive":false,"isSingleton":false,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":14,"sport":{"name":"\u8db3\u7403","slug":"football","status":"\u555f\u7528\u4e2d","id":1},"league":{"name":"\u897f\u73ed\u7259\u4e59\u7d1a\u806f\u8cfd","slug":"segunda-division","country":{"name":"\u897f\u73ed\u7259","slug":"spain"}},"teams":{"away":{"name":"\u963f\u723e\u79d1\u5b54","slug":"ad-alcorcon","id":533},"home":{"name":"\u5df4\u4e9e\u591a\u5229\u5fb7","slug":"real-valladolid","id":436}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":3,"status":"active","playId":2,"options":[{"name":"*2*","optionId":83,"odds":"4.75","trend":null,"status":"active","id":14673853,"officialCode":"402"},{"name":"\u548c\u5c40","optionId":84,"odds":"3.00","trend":null,"status":"active","id":14673854,"officialCode":"401"},{"name":"*1*","optionId":82,"odds":"1.50","trend":null,"status":"active","id":14673855,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420826},"layoutId":1,"playId":2},{"name":"\u8b93\u5206","markets":{"handicap":"-1.00","minPasses":3,"status":"active","playId":12,"options":[{"name":"*2*\uff08+1\uff09","optionId":342,"odds":"1.85","trend":null,"status":"active","id":14673856,"officialCode":"447"},{"name":"\u548c\u5c40","optionId":343,"odds":"3.25","trend":null,"status":"active","id":14673857,"officialCode":"446"},{"name":"*1*\uff08-1.00\uff09","optionId":344,"odds":"2.85","trend":null,"status":"active","id":14673858,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420827},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5206]","markets":{"handicap":"2.50","minPasses":3,"status":"active","playId":10,"options":[{"name":"\u5927 2.50","optionId":360,"odds":"2.15","trend":null,"status":"active","id":14673859,"officialCode":"472"},{"name":"\u5c0f 2.50","optionId":359,"odds":"1.45","trend":null,"status":"active","id":14673860,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420828},"layoutId":2,"playId":10}]},{"id":273036,"name":null,"status":"active","startAt":"2023-08-27 03:30:00","officialCode":563,"officialId":393108,"isLive":false,"isSingleton":false,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":14,"sport":{"name":"\u8db3\u7403","slug":"football","status":"\u555f\u7528\u4e2d","id":1},"league":{"name":"\u897f\u73ed\u7259\u4e59\u7d1a\u806f\u8cfd","slug":"segunda-division","country":{"name":"\u897f\u73ed\u7259","slug":"spain"}},"teams":{"away":{"name":"\u6bd4\u4e9e\u96f7\u4e9e\u723eB\u968a","slug":"villarreal-cf-b","id":22218},"home":{"name":"\u57c3\u723e\u5207","slug":"cf-elche","id":1880}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":3,"status":"active","playId":2,"options":[{"name":"*2*","optionId":83,"odds":"5.50","trend":null,"status":"active","id":14673928,"officialCode":"402"},{"name":"\u548c\u5c40","optionId":84,"odds":"3.40","trend":null,"status":"active","id":14673929,"officialCode":"401"},{"name":"*1*","optionId":82,"odds":"1.35","trend":null,"status":"active","id":14673930,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420840},"layoutId":1,"playId":2},{"name":"\u8b93\u5206","markets":{"handicap":"-1.00","minPasses":3,"status":"active","playId":12,"options":[{"name":"*2*\uff08+1\uff09","optionId":342,"odds":"2.15","trend":null,"status":"active","id":14673931,"officialCode":"447"},{"name":"\u548c\u5c40","optionId":343,"odds":"3.10","trend":null,"status":"active","id":14673932,"officialCode":"446"},{"name":"*1*\uff08-1.00\uff09","optionId":344,"odds":"2.40","trend":null,"status":"active","id":14673933,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420841},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5206]","markets":{"handicap":"2.50","minPasses":3,"status":"active","playId":10,"options":[{"name":"\u5927 2.50","optionId":360,"odds":"2.05","trend":null,"status":"active","id":14673934,"officialCode":"472"},{"name":"\u5c0f 2.50","optionId":359,"odds":"1.50","trend":null,"status":"active","id":14673935,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420842},"layoutId":2,"playId":10}]},{"id":273037,"name":null,"status":"active","startAt":"2023-08-27 23:00:00","officialCode":564,"officialId":393109,"isLive":false,"isSingleton":false,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":14,"sport":{"name":"\u8db3\u7403","slug":"football","status":"\u555f\u7528\u4e2d","id":1},"league":{"name":"\u897f\u73ed\u7259\u4e59\u7d1a\u806f\u8cfd","slug":"segunda-division","country":{"name":"\u897f\u73ed\u7259","slug":"spain"}},"teams":{"away":{"name":"\u5e0c\u6d2a\u7af6\u6280","slug":"sporting-gijon","id":524},"home":{"name":"\u8cbb\u7f85\u723e\u7af6\u6280","slug":"racing-club-de-ferrol","id":23666}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":3,"status":"active","playId":2,"options":[{"name":"*2*","optionId":83,"odds":"2.90","trend":null,"status":"active","id":14674003,"officialCode":"402"},{"name":"\u548c\u5c40","optionId":84,"odds":"2.70","trend":null,"status":"active","id":14674004,"officialCode":"401"},{"name":"*1*","optionId":82,"odds":"2.05","trend":null,"status":"active","id":14674005,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420854},"layoutId":1,"playId":2},{"name":"\u8b93\u5206","markets":{"handicap":"-1.00","minPasses":3,"status":"active","playId":12,"options":[{"name":"*2*\uff08+1\uff09","optionId":342,"odds":"1.40","trend":null,"status":"active","id":14674006,"officialCode":"447"},{"name":"\u548c\u5c40","optionId":343,"odds":"3.60","trend":null,"status":"active","id":14674007,"officialCode":"446"},{"name":"*1*\uff08-1.00\uff09","optionId":344,"odds":"4.75","trend":null,"status":"active","id":14674008,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420855},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5206]","markets":{"handicap":"2.50","minPasses":3,"status":"active","playId":10,"options":[{"name":"\u5927 2.50","optionId":360,"odds":"2.45","trend":null,"status":"active","id":14674009,"officialCode":"472"},{"name":"\u5c0f 2.50","optionId":359,"odds":"1.35","trend":null,"status":"active","id":14674010,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420856},"layoutId":2,"playId":10}]}]},{"date":"2023-08-28","games":[{"id":273038,"name":null,"status":"active","startAt":"2023-08-28 01:30:00","officialCode":565,"officialId":393110,"isLive":false,"isSingleton":false,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":14,"sport":{"name":"\u8db3\u7403","slug":"football","status":"\u555f\u7528\u4e2d","id":1},"league":{"name":"\u897f\u73ed\u7259\u4e59\u7d1a\u806f\u8cfd","slug":"segunda-division","country":{"name":"\u897f\u73ed\u7259","slug":"spain"}},"teams":{"away":{"name":"\u7687\u5bb6\u897f\u73ed\u7259\u4eba","slug":"rcd-espanyol-barcelona","id":529},"home":{"name":"\u7c73\u862d\u8fea\u65af","slug":"cd-mirandes","id":2820}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":3,"status":"active","playId":2,"options":[{"name":"*2*","optionId":83,"odds":"1.95","trend":null,"status":"active","id":14674078,"officialCode":"402"},{"name":"\u548c\u5c40","optionId":84,"odds":"2.75","trend":null,"status":"active","id":14674079,"officialCode":"401"},{"name":"*1*","optionId":82,"odds":"3.00","trend":null,"status":"active","id":14674080,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420868},"layoutId":1,"playId":2},{"name":"\u8b93\u5206","markets":{"handicap":"1.00","minPasses":3,"status":"active","playId":12,"options":[{"name":"*2*\uff08-1\uff09","optionId":342,"odds":"4.25","trend":null,"status":"active","id":14674081,"officialCode":"447"},{"name":"\u548c\u5c40","optionId":343,"odds":"3.60","trend":null,"status":"active","id":14674082,"officialCode":"446"},{"name":"*1*\uff08+1\uff09","optionId":344,"odds":"1.45","trend":null,"status":"active","id":14674083,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420869},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5206]","markets":{"handicap":"2.50","minPasses":3,"status":"active","playId":10,"options":[{"name":"\u5927 2.50","optionId":360,"odds":"2.15","trend":null,"status":"active","id":14674084,"officialCode":"472"},{"name":"\u5c0f 2.50","optionId":359,"odds":"1.45","trend":null,"status":"active","id":14674085,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420870},"layoutId":2,"playId":10}]},{"id":273039,"name":null,"status":"active","startAt":"2023-08-28 01:30:00","officialCode":566,"officialId":393111,"isLive":false,"isSingleton":false,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":14,"sport":{"name":"\u8db3\u7403","slug":"football","status":"\u555f\u7528\u4e2d","id":1},"league":{"name":"\u897f\u73ed\u7259\u4e59\u7d1a\u806f\u8cfd","slug":"segunda-division","country":{"name":"\u897f\u73ed\u7259","slug":"spain"}},"teams":{"away":{"name":"FC\u5b89\u9053\u723e","slug":"fc-andorra","id":22219},"home":{"name":"\u963f\u83ab\u96f7\u5225\u5854","slug":"amorebieta","id":5861}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":3,"status":"active","playId":2,"options":[{"name":"*2*","optionId":83,"odds":"2.10","trend":null,"status":"active","id":14674153,"officialCode":"402"},{"name":"\u548c\u5c40","optionId":84,"odds":"2.65","trend":null,"status":"active","id":14674154,"officialCode":"401"},{"name":"*1*","optionId":82,"odds":"2.85","trend":null,"status":"active","id":14674155,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420882},"layoutId":1,"playId":2},{"name":"\u8b93\u5206","markets":{"handicap":"1.00","minPasses":3,"status":"active","playId":12,"options":[{"name":"*2*\uff08-1\uff09","optionId":342,"odds":"5.00","trend":null,"status":"active","id":14674156,"officialCode":"447"},{"name":"\u548c\u5c40","optionId":343,"odds":"3.75","trend":null,"status":"active","id":14674157,"officialCode":"446"},{"name":"*1*\uff08+1\uff09","optionId":344,"odds":"1.40","trend":null,"status":"active","id":14674158,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420883},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5206]","markets":{"handicap":"2.50","minPasses":3,"status":"active","playId":10,"options":[{"name":"\u5927 2.50","optionId":360,"odds":"2.45","trend":null,"status":"active","id":14674159,"officialCode":"472"},{"name":"\u5c0f 2.50","optionId":359,"odds":"1.35","trend":null,"status":"active","id":14674160,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420884},"layoutId":2,"playId":10}]},{"id":273040,"name":null,"status":"active","startAt":"2023-08-28 03:30:00","officialCode":567,"officialId":393112,"isLive":false,"isSingleton":false,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":14,"sport":{"name":"\u8db3\u7403","slug":"football","status":"\u555f\u7528\u4e2d","id":1},"league":{"name":"\u897f\u73ed\u7259\u4e59\u7d1a\u806f\u8cfd","slug":"segunda-division","country":{"name":"\u897f\u73ed\u7259","slug":"spain"}},"teams":{"away":{"name":"\u963f\u723e\u5df4\u585e\u7279","slug":"albacete-balompie","id":467},"home":{"name":"\u840a\u52a0\u5167\u65af","slug":"cd-leganes","id":665}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":{"handicap":null,"minPasses":3,"status":"active","playId":2,"options":[{"name":"*2*","optionId":83,"odds":"2.75","trend":null,"status":"active","id":14674228,"officialCode":"402"},{"name":"\u548c\u5c40","optionId":84,"odds":"2.65","trend":null,"status":"active","id":14674229,"officialCode":"401"},{"name":"*1*","optionId":82,"odds":"2.15","trend":null,"status":"active","id":14674230,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420896},"layoutId":1,"playId":2},{"name":"\u8b93\u5206","markets":{"handicap":"-1.00","minPasses":3,"status":"active","playId":12,"options":[{"name":"*2*\uff08+1\uff09","optionId":342,"odds":"1.35","trend":null,"status":"active","id":14674231,"officialCode":"447"},{"name":"\u548c\u5c40","optionId":343,"odds":"3.75","trend":null,"status":"active","id":14674232,"officialCode":"446"},{"name":"*1*\uff08-1.00\uff09","optionId":344,"odds":"5.25","trend":null,"status":"active","id":14674233,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420897},"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5206]","markets":{"handicap":"2.50","minPasses":3,"status":"active","playId":10,"options":[{"name":"\u5927 2.50","optionId":360,"odds":"2.45","trend":null,"status":"active","id":14674234,"officialCode":"472"},{"name":"\u5c0f 2.50","optionId":359,"odds":"1.35","trend":null,"status":"active","id":14674235,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420898},"layoutId":2,"playId":10}]}]}],"others":null}'
        ));

        $leagues = $caerus->league('wta')
                          ->get();

        //assert
        $this->assertArrayHasKey('slug' ,$leagues);
    }

    /**
     * @test
     * @throws \Exception
     */
    public function testFetchGame(){
        //arrange
        $caerues = new Caerus($this->mockRequest(
            'get' ,
            '{"id":273032,"name":null,"status":"active","startAt":"2023-08-26 03:30:00","officialCode":558,"officialId":393104,"isLive":false,"isSingleton":false,"type":1,"neutral":false,"trans":{"groups":"games","key":null},"activePlayCount":14,"sport":{"name":"\u8db3\u7403","slug":"football","status":"\u555f\u7528\u4e2d","id":1},"league":{"name":"\u897f\u73ed\u7259\u4e59\u7d1a\u806f\u8cfd","slug":"segunda-division","country":{"name":"\u897f\u73ed\u7259","slug":"spain"}},"teams":{"away":{"name":"\u840a\u842c\u7279","slug":"ud-levante","id":310},"home":{"name":"\u5361\u5854\u8d6b\u7d0d","slug":"fc-cartagena","id":5276}},"result":null,"rrc":null,"mac":null,"groups":[{"name":"\u4e0d\u8b93\u5206","markets":[{"handicap":null,"minPasses":3,"status":"active","playId":2,"options":[{"name":"*2*","optionId":83,"odds":"2.30","trend":null,"status":"active","id":14673633,"officialCode":"402"},{"name":"\u548c\u5c40","optionId":84,"odds":"2.80","trend":null,"status":"active","id":14673634,"officialCode":"401"},{"name":"*1*","optionId":82,"odds":"2.40","trend":null,"status":"active","id":14673635,"officialCode":"400"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420786}],"layoutId":1,"playId":2},{"name":"\u8b93\u5206","markets":[{"handicap":"1.00","minPasses":3,"status":"active","playId":12,"options":[{"name":"*2*\uff08-1\uff09","optionId":342,"odds":"5.50","trend":null,"status":"active","id":14673636,"officialCode":"447"},{"name":"\u548c\u5c40","optionId":343,"odds":"4.00","trend":null,"status":"active","id":14673637,"officialCode":"446"},{"name":"*1*\uff08+1\uff09","optionId":344,"odds":"1.30","trend":null,"status":"active","id":14673638,"officialCode":"445"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420787}],"layoutId":1,"playId":12},{"name":"\u5927\u5c0f[\u7e3d\u5206]","markets":[{"handicap":"1.50","minPasses":3,"status":"active","playId":37,"options":[{"name":"\u5927 1.5","optionId":347,"odds":"1.30","trend":null,"status":"active","id":14673641,"officialCode":"470"},{"name":"\u5c0f 1.5","optionId":348,"odds":"2.60","trend":null,"status":"active","id":14673642,"officialCode":"469"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420789},{"handicap":"2.50","minPasses":3,"status":"active","playId":10,"options":[{"name":"\u5927 2.50","optionId":360,"odds":"2.15","trend":null,"status":"active","id":14673639,"officialCode":"472"},{"name":"\u5c0f 2.50","optionId":359,"odds":"1.45","trend":null,"status":"active","id":14673640,"officialCode":"471"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420788},{"handicap":"3.50","minPasses":3,"status":"active","playId":31,"options":[{"name":"\u5927 3.5","optionId":358,"odds":"4.00","trend":null,"status":"active","id":14673643,"officialCode":"474"},{"name":"\u5c0f 3.5","optionId":357,"odds":"1.10","trend":null,"status":"active","id":14673644,"officialCode":"473"}],"layout_id":2,"description":null,"prevHandicap":null,"id":4420790}],"layoutId":2,"playId":37},{"name":"\u6b63\u78ba\u9032\u7403\u6578","markets":[{"handicap":null,"minPasses":3,"status":"active","playId":30,"options":[{"name":"0\u7403","optionId":271,"odds":"6.00","trend":null,"status":"active","id":14673648,"officialCode":"549"},{"name":"1\u7403","optionId":276,"odds":"3.30","trend":null,"status":"active","id":14673649,"officialCode":"550"},{"name":"2\u7403","optionId":273,"odds":"2.90","trend":null,"status":"active","id":14673650,"officialCode":"551"},{"name":"3\u7403","optionId":272,"odds":"3.75","trend":null,"status":"active","id":14673651,"officialCode":"552"},{"name":"4\u7403","optionId":275,"odds":"6.25","trend":null,"status":"active","id":14673652,"officialCode":"553"},{"name":"5 \u7403(\u6216\u4ee5\u4e0a)","optionId":274,"odds":"8.75","trend":null,"status":"active","id":14673653,"officialCode":"554"}],"layout_id":7,"description":null,"prevHandicap":null,"id":4420792}],"layoutId":7,"playId":30},{"name":"\u6b63\u78ba\u9032\u7403\u6578[\u5ba2\u968a]","markets":[{"handicap":null,"minPasses":3,"status":"active","playId":26,"options":[{"name":"0\u7403","optionId":259,"odds":"2.55","trend":null,"status":"active","id":14673654,"officialCode":"567"},{"name":"1\u7403","optionId":260,"odds":"2.20","trend":null,"status":"active","id":14673655,"officialCode":"568"},{"name":"2\u7403","optionId":261,"odds":"3.75","trend":null,"status":"active","id":14673656,"officialCode":"569"},{"name":"3 \u7403(\u6216\u4ee5\u4e0a)","optionId":262,"odds":"7.00","trend":null,"status":"active","id":14673657,"officialCode":"570"}],"layout_id":7,"description":null,"prevHandicap":null,"id":4420793}],"layoutId":7,"playId":26},{"name":"\u6b63\u78ba\u9032\u7403\u6578[\u4e3b\u968a]","markets":[{"handicap":null,"minPasses":3,"status":"active","playId":27,"options":[{"name":"0\u7403","optionId":264,"odds":"2.50","trend":null,"status":"active","id":14673658,"officialCode":"563"},{"name":"1\u7403","optionId":266,"odds":"2.20","trend":null,"status":"active","id":14673659,"officialCode":"564"},{"name":"2\u7403","optionId":265,"odds":"4.00","trend":null,"status":"active","id":14673660,"officialCode":"565"},{"name":"3 \u7403(\u6216\u4ee5\u4e0a)","optionId":263,"odds":"7.50","trend":null,"status":"active","id":14673661,"officialCode":"566"}],"layout_id":7,"description":null,"prevHandicap":null,"id":4420794}],"layoutId":7,"playId":27},{"name":"\u7e3d\u9032\u7403\u6578","markets":[{"handicap":null,"minPasses":3,"status":"active","playId":38,"options":[{"name":"0-1 \u7403","optionId":295,"odds":"2.60","trend":null,"status":"active","id":14673645,"officialCode":"587"},{"name":"2-3 \u7403","optionId":297,"odds":"1.75","trend":null,"status":"active","id":14673646,"officialCode":"588"},{"name":"4\u7403(\u6216\u4ee5\u4e0a)","optionId":296,"odds":"4.00","trend":null,"status":"active","id":14673647,"officialCode":"589"}],"layout_id":7,"description":null,"prevHandicap":null,"id":4420791}],"layoutId":7,"playId":38},{"name":"\u5169\u968a\u662f\u5426\u90fd\u9032\u7403","markets":[{"handicap":null,"minPasses":3,"status":"active","playId":39,"options":[{"name":"\u662f","optionId":299,"odds":"1.85","trend":null,"status":"active","id":14673706,"officialCode":"592"},{"name":"\u5426","optionId":298,"odds":"1.65","trend":null,"status":"active","id":14673707,"officialCode":"591"}],"layout_id":6,"description":null,"prevHandicap":null,"id":4420799}],"layoutId":6,"playId":39},{"name":"\u55ae\u96d9[\u7e3d\u5206]","markets":[{"handicap":null,"minPasses":3,"status":"active","playId":5,"options":[{"name":"\u55ae","optionId":288,"odds":"1.80","trend":null,"status":"active","id":14673662,"officialCode":"597"},{"name":"\u96d9","optionId":287,"odds":"1.70","trend":null,"status":"active","id":14673663,"officialCode":"598"}],"layout_id":6,"description":null,"prevHandicap":null,"id":4420795}],"layoutId":6,"playId":5},{"name":"\u6b63\u78ba\u6bd4\u6578","markets":[{"handicap":null,"minPasses":1,"status":"active","playId":9,"options":[{"name":"1:0","optionId":188,"odds":"5.50","trend":null,"status":"active","id":14673664,"officialCode":"659"},{"name":"0:0","optionId":174,"odds":"6.00","trend":null,"status":"active","id":14673665,"officialCode":"616"},{"name":"0:1","optionId":175,"odds":"5.50","trend":null,"status":"active","id":14673666,"officialCode":"617"},{"name":"2:0","optionId":237,"odds":"9.50","trend":null,"status":"active","id":14673667,"officialCode":"660"},{"name":"1:1","optionId":214,"odds":"4.50","trend":null,"status":"active","id":14673668,"officialCode":"639"},{"name":"0:2","optionId":176,"odds":"10.00","trend":null,"status":"active","id":14673669,"officialCode":"618"},{"name":"2:1","optionId":197,"odds":"8.25","trend":null,"status":"active","id":14673670,"officialCode":"653"},{"name":"2:2","optionId":187,"odds":"13.00","trend":null,"status":"active","id":14673671,"officialCode":"640"},{"name":"1:2","optionId":199,"odds":"8.50","trend":null,"status":"active","id":14673672,"officialCode":"624"},{"name":"3:0","optionId":241,"odds":"25.00","trend":null,"status":"active","id":14673673,"officialCode":"661"},{"name":"3:3","optionId":185,"odds":"90.00","trend":null,"status":"active","id":14673674,"officialCode":"641"},{"name":"0:3","optionId":177,"odds":"25.00","trend":null,"status":"active","id":14673675,"officialCode":"619"},{"name":"3:1","optionId":191,"odds":"20.00","trend":null,"status":"active","id":14673676,"officialCode":"654"},{"name":"4:4","optionId":186,"odds":"500.00","trend":null,"status":"active","id":14673677,"officialCode":"642"},{"name":"1:3","optionId":206,"odds":"22.00","trend":null,"status":"active","id":14673678,"officialCode":"625"},{"name":"3:2","optionId":179,"odds":"35.00","trend":null,"status":"active","id":14673679,"officialCode":"648"},{"name":"5+:5+","optionId":184,"odds":"500.00","trend":null,"status":"active","id":14673680,"officialCode":"643"},{"name":"2:3","optionId":216,"odds":"38.00","trend":null,"status":"active","id":14673681,"officialCode":"630"},{"name":"4:0","optionId":240,"odds":"80.00","trend":null,"status":"active","id":14673682,"officialCode":"662"},{"name":"0:4","optionId":207,"odds":"90.00","trend":null,"status":"active","id":14673683,"officialCode":"620"},{"name":"4:1","optionId":190,"odds":"70.00","trend":null,"status":"active","id":14673684,"officialCode":"655"},{"name":"1:4","optionId":205,"odds":"75.00","trend":null,"status":"active","id":14673685,"officialCode":"626"},{"name":"4:2","optionId":178,"odds":"120.00","trend":null,"status":"active","id":14673686,"officialCode":"649"},{"name":"2:4","optionId":217,"odds":"130.00","trend":null,"status":"active","id":14673687,"officialCode":"631"},{"name":"4:3","optionId":182,"odds":"300.00","trend":null,"status":"active","id":14673688,"officialCode":"645"},{"name":"3:4","optionId":210,"odds":"350.00","trend":null,"status":"active","id":14673689,"officialCode":"635"},{"name":"5:0","optionId":239,"odds":"275.00","trend":null,"status":"active","id":14673690,"officialCode":"663"},{"name":"0:5+","optionId":202,"odds":"300.00","trend":null,"status":"active","id":14673691,"officialCode":"621"},{"name":"5+:1","optionId":193,"odds":"250.00","trend":null,"status":"active","id":14673692,"officialCode":"656"},{"name":"1:5+","optionId":204,"odds":"275.00","trend":null,"status":"active","id":14673693,"officialCode":"627"},{"name":"5+:2","optionId":194,"odds":"400.00","trend":null,"status":"active","id":14673694,"officialCode":"650"},{"name":"2:5+","optionId":209,"odds":"450.00","trend":null,"status":"active","id":14673695,"officialCode":"632"},{"name":"5+:3","optionId":181,"odds":"500.00","trend":null,"status":"active","id":14673696,"officialCode":"646"},{"name":"3:5+","optionId":213,"odds":"500.00","trend":null,"status":"active","id":14673697,"officialCode":"636"},{"name":"5+:4","optionId":183,"odds":"500.00","trend":null,"status":"active","id":14673698,"officialCode":"644"},{"name":"4:5+","optionId":215,"odds":"500.00","trend":null,"status":"active","id":14673699,"officialCode":"638"}],"layout_id":3,"description":null,"prevHandicap":null,"id":4420796}],"layoutId":3,"playId":9},{"name":"\u8b93\u5206\u7372\u52dd\u968a\u4f0d\uff08-1\/+1\uff09","markets":[{"handicap":"1.00","minPasses":3,"status":"active","playId":56,"options":[{"name":"\u548c\u5c40 \u6216 *2*","optionId":339,"odds":"2.32","trend":null,"status":"active","id":14673703,"officialCode":"450"},{"name":"*1* \/ *2*","optionId":340,"odds":"1.05","trend":null,"status":"active","id":14673704,"officialCode":"449"},{"name":"*1* \u6216 \u548c\u5c40","optionId":341,"odds":"1.00","trend":null,"status":"blocked","id":14673705,"officialCode":"448"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420798}],"layoutId":1,"playId":56},{"name":"\u4e0d\u8b93\u5206\u7372\u52dd\u968a\u4f0d","markets":[{"handicap":null,"minPasses":3,"status":"active","playId":57,"options":[{"name":"\u548c\u5c40 \u6216 *2*","optionId":81,"odds":"1.26","trend":null,"status":"active","id":14673700,"officialCode":"405"},{"name":"*1* \u6216 *2*","optionId":85,"odds":"1.17","trend":null,"status":"active","id":14673701,"officialCode":"404"},{"name":"*1* \u6216 \u548c\u5c40","optionId":86,"odds":"1.29","trend":null,"status":"active","id":14673702,"officialCode":"403"}],"layout_id":1,"description":null,"prevHandicap":null,"id":4420797}],"layoutId":1,"playId":57}],"votes":[]}'
        ));

        $id = '273032';

        //action
        $game = $caerues->game($id)
                        ->get();

        //assert
        $this->assertArrayHasKey('id' ,$game);
    }

    /**
     * @test
     * @throws \Exception
     */
    public function testFetchGameWithMainPlay(){
        //arrange
        $caerus = new Caerus(new SendRequest());

        $url = $caerus->league('wta')
                          ->onlyMainPlay()
                          ->url();

        //assert
        $this->assertEquals('/leagues/wta?plays=2,10,12' ,$url);
    }

    /**
     * @test
     * @throws \Exception
     */
    public function testFetchTrending(){
        //arrange
        $url = 'https://api.airsports.com.tw/trending/football?gamingType=agent&lang=zh_TW';
        $caerus = new Caerus($this->mockRequest(
            'get' ,
            json_encode([
                'data' => [
                    'en' => 'football',
                    'id' => 1,
                    'leagues' => [],
                    'match_league_by_type' => [],
                    'num_of_games' => 84,
                    'num_of_normal_games' => 84,
                    'official_id' => '',
                    'slug' => 'football',
                    'status_id' => '2',
                    'zh_TW' => '足球'
                ],
                'sports' => []
            ])
        ));
        //action
        $res = $caerus->sport('football')
                      ->trending()
                      ->get();

        //assert
        $this->assertArrayHasKey('data' ,$res);
    }
}